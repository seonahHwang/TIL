# 6장 전송 계층 : 신뢰할 수 있는 데이터 전송하기

# lesson 23 : 전송 계층의 역할

## 1. 전송 계층의 두 가지 역할

1) 오류 점검 기능

오류가 발생하면 데이터를 재전송하도록 요청 

2) 전송된 데이터의 목적지가 어떤 애플리케이션인지 식별

ex) 메일 프로그램인지 홈페이지 인지 식별 

## 2. 연결형 통신과 비연결형 통신

연결형 TCP

상대방 확인. 신뢰성 

비연결형 UDP

효율성 우선

# lesson 24 : TCP의 구조

TCP 헤더 : TCP로 전송할 때 데이터에 붙이는 헤더

세그먼트 : TCP 헤더가 붙은 데이터 

데이터를 전송하기 전에 연결을 확보해야함!

TCP 헤더의 코드 비트(6비트)에 SYN ACK FIN 등이 있음

SYN : 연결 요청

ACK : 확인 응답

## 3 way handshake

연결 확립을 위해 패킷 교환을 세번 하는 것

SYN, ACK를 이용하여 3 way handshake를 함

1. 연결 확립 요청

    A → B (SYN)

2. 연결 확립 응답, 연결 확립 요청

    B → A (SYN, ACK)

3. 연결 확립 응답

    A → B (ACK)

연결 종료시에는 FIN, ACK를 사용


---------------------------------------

# TCP와 UDP 헤더

TCP/UDP

전송계층에서 사용하는 프로토콜로써, 

목적지 장비까지 전송한 패킷을 상위의 특정 응용 프로토콜에 전달하는 것에 목적이 있다.

TCP와 UDP의 가장 큰 차이는 세그먼트 전달의 신뢰성에 있다.

# TCP

수신한 세그먼트에 에러가 발생하면 재전송을 요구하여 에러를 복구한다. 

신뢰성 O

처리속도 느림

# UDP

에러가 발생한 세그먼트는 폐기시킨다.

신뢰성 X

처리속도 빠름

![스크린샷 2021-09-12 오후 10.23.31.png](TCP%E1%84%8B%E1%85%AA%20UDP%20%E1%84%92%E1%85%A6%E1%84%83%E1%85%A5%20fcffb91eba7148e1aa564277c920ed1f/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2021-09-12_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_10.23.31.png)

7) 코드비트 :  107번째비트~ 112번째 비트. 연결의 제어 정보 기록

![스크린샷 2021-09-12 오후 10.26.27.png](TCP%E1%84%8B%E1%85%AA%20UDP%20%E1%84%92%E1%85%A6%E1%84%83%E1%85%A5%20fcffb91eba7148e1aa564277c920ed1f/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2021-09-12_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_10.26.27.png)

ACK 확인응답

SYN 연결요청

[Untitled](https://www.notion.so/d532bce16f74472d8653be0a807666cb)

# UDP 헤더정보

![스크린샷 2021-09-12 오후 10.22.57.png](TCP%E1%84%8B%E1%85%AA%20UDP%20%E1%84%92%E1%85%A6%E1%84%83%E1%85%A5%20fcffb91eba7148e1aa564277c920ed1f/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2021-09-12_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_10.22.57.png)

# TCP 핸드쉐이크

![스크린샷 2021-09-12 오후 10.35.29.png](TCP%E1%84%8B%E1%85%AA%20UDP%20%E1%84%92%E1%85%A6%E1%84%83%E1%85%A5%20fcffb91eba7148e1aa564277c920ed1f/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2021-09-12_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_10.35.29.png)

TCP 통신을 위한 네트워크 연결은 3 way handshake 이라는 방식으로 연결

3 way handshake 방식

: 서로의 통신을 위한 관문(port)을 확인하고 연결하기 위하여 3번의 요청/응답 후에 연결이 되는 것

TCP 통신에서 사용하는 신뢰성을 제공하기 위한 통신 방식

컴퓨터 간에 연결을 맺기 위한 초기화 과정으로 세 단계로 되어있어서 3way

### **연결 과정**

1. Client에서 Server에 연결 요청을 하기위해 SYN 데이터를 보낸다.
2. Server에서 해당 포트는 LISTEN 상태에서 SYN 데이터를 받고 SYN_RCV로 상태가 변경된다.
3. 그리고 요청을 정상적으로 받았다는 대답(ACK)와 Client도 포트를 열어달라는 SYN 을 같이 보낸다.
4. Client에서는 SYN+ACK 를 받고 ESTABLISHED로 상태를 변경하고 서버에 ACK 를 전송한다.
5. ACK를 받은 서버는 상태가 ESTABLSHED로 변경된다.

대역폭 

: 정해진 시간 동안 전송될 수 있는 데이터의 양 (주로 속도 의미)

일련번호

: TCP에서는 데이터를 보낼 때 마다 각 데이터에 고유한 번호를 부여해서 전송 시도

이 번호를 이용하여 TCP 패킷의 순서 제어 가능 

포트 번호

: 컴퓨터가 데이터 통신을 할 때 통신하고자 하는 네트워크 서비스나 특정 프로세스를 식별하는 논리 단위 

출처 

: [https://coding-factory.tistory.com/614](https://coding-factory.tistory.com/614)

모두의 네트워크
